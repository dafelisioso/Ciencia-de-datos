x=read.table('SwissBank 1.txt')
x[,1] <- x[,1]/10
x[,2] <- x[,2]/10
x[,3] <- x[,3]/10
x[,6] <- x[,6]/10

n = nrow(x)
#calculates eigenvalues and eigenvectors and sorts them by size
e = eigen((n - 1) * cov(x) / n)
e1 = e$values
#data multiplied by eigenvectors
x = as.matrix(x) %*% e$vectors
par(mfrow = c(2, 2))
#plot of the first vs. second PC
plot(x[, 1], x[, 2], pch = c(rep(1, 100), rep(3, 100)),
     col = c(rep("blue", 100), rep("red", 100)),
     xlab = "PC1", ylab = "PC2", main = "First vs. Second PC",
     cex.lab = 1.2, cex.axis = 1.2, cex.main = 1.8)
#plot of the second vs. third PC
plot(x[, 2], x[, 3], pch = c(rep(1, 100), rep(3, 100)),
     col = c(rep("blue", 100), rep("red", 100)),
     ylim = c(-238.5, -241.5), xlab = "PC2",
     ylab = "PC3", main = "Second vs. Third PC",
     cex.lab = 1.2, cex.axis = 1.2, cex.main = 1.8)
#plot of the first vs. third PC
plot(x[, 1], x[, 3], pch = c(rep(1, 100), rep(3, 100)),
     col = c(rep("blue", 100), rep("red", 100)),
     ylim = c(-238.5, -241.5), xlab = "PC1", ylab = "PC2",
     main = "First vs. Third PC",
     cex.lab = 1.2, cex.axis = 1.2, cex.main = 1.8)
#plot of the eigenvalues
plot(e1, ylim = c(0, 3), xlab = "Index", ylab = "Lambda",
     main = "Eigenvalues of S",
     cex.lab = 1.2, cex.axis = 1.2, cex.main = 1.8)

